<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Lorentz transformations — boost • lorentz</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Lorentz transformations — boost"><meta name="description" content="Lorentz transformations: boosts and rotations"><meta property="og:description" content="Lorentz transformations: boosts and rotations"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lorentz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RobinHankin/lorentz/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Lorentz transformations</h1>

      <div class="d-none name"><code>boost.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Lorentz transformations: boosts and rotations</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">boost</span><span class="op">(</span>u<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu">rot</span><span class="op">(</span><span class="va">u</span>,<span class="va">v</span>,space<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">is.consistent.boost</span><span class="op">(</span><span class="va">L</span>, give<span class="op">=</span><span class="cn">FALSE</span>, TOL<span class="op">=</span><span class="fl">1e-10</span><span class="op">)</span></span>
<span><span class="fu">is.consistent.boost.galilean</span><span class="op">(</span><span class="va">L</span>, give<span class="op">=</span><span class="cn">FALSE</span>, TOL<span class="op">=</span><span class="fl">1e-10</span><span class="op">)</span></span>
<span><span class="fu">pureboost</span><span class="op">(</span><span class="va">L</span>,include_sol<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">orthog</span><span class="op">(</span><span class="va">L</span><span class="op">)</span></span>
<span><span class="fu">pureboost.galilean</span><span class="op">(</span><span class="va">L</span>, tidy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">orthog.galilean</span><span class="op">(</span><span class="va">L</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-u-v">u,v<a class="anchor" aria-label="anchor" href="#arg-u-v"></a></dt>
<dd><p>Three-velocities, coerced to  class <code>3vel</code>.  In
    function <code>boost()</code>, if <code>u</code> takes the special default value
    <code>0</code>, this is interpreted as zero three velocity</p></dd>

  <dt id="arg-l">L<a class="anchor" aria-label="anchor" href="#arg-l"></a></dt>
<dd><p>Lorentz transform expressed as a \(4\times 4\) matrix</p></dd>

  <dt id="arg-tol">TOL<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Numerical tolerance</p></dd>

  <dt id="arg-give">give<a class="anchor" aria-label="anchor" href="#arg-give"></a></dt>
<dd><p>Boolean with <code>TRUE</code> meaning to return the transformed
    metric tensor (which should be the flat-space <code><a href="sol.html">eta()</a></code>; qv) and
    default <code>FALSE</code> meaning to return whether the matrix is a
    consistent boost or not</p></dd>

  <dt id="arg-space">space<a class="anchor" aria-label="anchor" href="#arg-space"></a></dt>
<dd><p>Boolean, with default <code>TRUE</code> meaning to return just
    the spatial component of the rotation matrix and <code>FALSE</code>
    meaning to return the full \(4\times 4\) matrix
    transformation</p></dd>

  <dt id="arg-tidy">tidy<a class="anchor" aria-label="anchor" href="#arg-tidy"></a></dt>
<dd><p>In <code>pureboost.galilean()</code>, Boolean with default
    <code>TRUE</code> meaning to return a “tidy” boost matrix with
    spatial components forced to be a \(3\times 3\) identity
    matrix</p></dd>

  <dt id="arg-include-sol">include_sol<a class="anchor" aria-label="anchor" href="#arg-include-sol"></a></dt>
<dd><p>In function <code>pureboost()</code>, Boolean with
    default <code>TRUE</code> meaning to correctly account for the speed of
    light, and <code>FALSE</code> meaning to assume \(c=1\). See details</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Function <code>boost()</code> returns a \(4\times 4\)
  matrix; function <code>rot()</code> returns an orthogonal matrix.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Arguments <code>u,v</code> are coerced to three-velocities.</p>
<p>A rotation-free Lorentz transformation is known as a <dfn>boost</dfn>
  (sometimes a <dfn>pure boost</dfn>), here expressed in matrix form.  Pure
  boost matrices are symmetric if \(c=1\).  Function <code>boost(u)</code>
  returns a \(4\times 4\) matrix giving the Lorentz transform of
  an arbitrary three-velocity <code>u</code>.</p>
<p>Boosts can be successively applied with regular matrix multiplication.
  However, composing two successive pure boosts does not in general
  return a pure boost matrix: the product is not symmetric in general.
  Also note that boost matrices do not commute.  The resulting matrix
  product represents a <dfn>Lorentz transform</dfn>.</p>
<p>It is possible to decompose a Lorentz transform \(L\) into a pure
  boost and a spatial rotation.  Thus \(L=OP\) where \(O\) is an
  orthogonal matrix and \(P\) a pure boost matrix; these are returned by
  functions <code>orthog()</code> and <code>pureboost()</code> respectively.  If the
  speed of light is not equal to 1, the functions still work but can be
  confusing.</p>
<p>Functions <code>pureboost.galilean()</code> and <code>orthog.galilean()</code> are
  the Newtonian equivalents of <code>pureboost()</code> and <code>orthog()</code>,
  intended to be used when the speed of light is infinite (which causes
  problems for the relativistic functions).</p>
<p>As noted above, the composition of two pure Lorentz boosts is not
  necessarily pure.  If we have two successive boosts corresponding to
  \(u\) and \(v\), then the composed boost may be decomposed into a
  pure boost of <code>boost(u+v)</code> and a rotation of <code>rot(u,v)</code>.</p>
<p>The reason argument <code>include_sol</code> exists is that function
  <code>orthog()</code> needs to call <code>pureboost()</code> in an environment
  where we pretend that \(c=1\).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p></p><ul><li><p>Ungar 2006. “Thomas precession: a kinematic
      effect...”. European Journal of Physics, 27:L17-L20</p></li>
<li><p>Sbitneva 2001. “Nonassociative geometry of special relativity”.
    International Journal of Theoretical Physics, volume 40, number 1,
      pages 359–362</p></li>
<li><p>Wikipedia contributors 2018.  “Wigner rotation”,
  Wikipedia, The Free Encyclopedia.
  <a href="https://en.wikipedia.org/w/index.php?title=Wigner_rotation&amp;oldid=838661305" class="external-link">https://en.wikipedia.org/w/index.php?title=Wigner_rotation&amp;oldid=838661305</a>.  Online; accessed 23 August 2018</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Robin K. S. Hankin</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Function <code>rot()</code> uses <code><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod()</a></code> for efficiency reasons
but is algebraically equivalent to</p>
<p><code>boost(-u-v) %*% boost(u) %*% boost(v)</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">boost</span><span class="op">(</span><span class="fu"><a href="threevel.html">as.3vel</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>,<span class="op">-</span><span class="fl">0.2</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            t           x           y           z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t  1.1250879 -0.45003516  0.22501758 -0.11250879</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x -0.4500352  1.09530507 -0.04765253  0.02382627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  0.2250176 -0.04765253  1.02382627 -0.01191313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z -0.1125088  0.02382627 -0.01191313  1.00595657</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="r3vel.html">r3vel</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="r3vel.html">r3vel</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="r3vel.html">r3vel</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">boost</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu">boost</span><span class="op">(</span><span class="op">-</span><span class="va">u</span><span class="op">)</span><span class="op">)</span>  <span class="co"># should be zero</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               t             x             y            z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t -2.220446e-16 -1.110223e-16  1.110223e-16 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x -5.551115e-17 -4.440892e-16 -2.081668e-17 3.469447e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  0.000000e+00 -2.775558e-17  2.220446e-16 2.775558e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z  0.000000e+00  3.469447e-17  0.000000e+00 0.000000e+00</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">boost</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu">boost</span><span class="op">(</span><span class="va">v</span><span class="op">)</span>   <span class="co"># not a pure boost (not symmetrical)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            t          x           y          z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t  1.9785365  0.6997728  0.09466761 -1.5543367</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  0.6577317  1.1507970 -0.06296776 -0.3229743</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  0.4431298  0.1902924  0.99271578 -0.4179333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z -1.5118305 -0.3593565  0.13968679  1.7711527</span>
<span class="r-in"><span><span class="fu">boost</span><span class="op">(</span><span class="va">u</span><span class="op">+</span><span class="va">v</span><span class="op">)</span>  <span class="co"># not the same!</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            t           x           y          z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t  1.9785365  0.65773173  0.44312981 -1.5118305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  0.6577317  1.14524282  0.09785361 -0.3338482</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  0.4431298  0.09785361  1.06592635 -0.2249216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z -1.5118305 -0.33384815 -0.22492159  1.7673673</span>
<span class="r-in"><span><span class="fu">boost</span><span class="op">(</span><span class="va">v</span><span class="op">+</span><span class="va">u</span><span class="op">)</span>  <span class="co"># also not the same!</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             t           x           y           z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t  1.97853648  0.69977283  0.09466761 -1.55433672</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  0.69977283  1.16440357  0.02224106 -0.36517351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  0.09466761  0.02224106  1.00300885 -0.04940189</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z -1.55433672 -0.36517351 -0.04940189  1.81112407</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">u</span><span class="op">+</span><span class="va">v</span>  <span class="co"># returns a three-velocity</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A vector of three-velocities (speed of light = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               x          y         z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.3324335 -0.2239685 0.7641156</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">boost</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu">boost</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu">boost</span><span class="op">(</span><span class="va">w</span><span class="op">)</span>  <span class="co"># associative, no brackets needed</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            t         x           y          z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t  2.4816250  1.843221 -0.04708488 -1.3261908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  1.3585858  1.667719 -0.12705019 -0.2198357</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  0.5002695  0.432151  0.96273274 -0.3696766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z -1.7499822 -1.195585  0.24335345  1.6043047</span>
<span class="r-in"><span><span class="fu">boost</span><span class="op">(</span><span class="va">u</span><span class="op">+</span><span class="op">(</span><span class="va">v</span><span class="op">+</span><span class="va">w</span><span class="op">)</span><span class="op">)</span>  <span class="co"># not the same!</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            t          x          y          z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t  2.4816250  1.3585858  0.5002695 -1.7499822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  1.3585858  1.5301419  0.1952132 -0.6828711</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  0.5002695  0.1952132  1.0718830 -0.2514523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z -1.7499822 -0.6828711 -0.2514523  1.8796001</span>
<span class="r-in"><span><span class="fu">boost</span><span class="op">(</span><span class="op">(</span><span class="va">u</span><span class="op">+</span><span class="va">v</span><span class="op">)</span><span class="op">+</span><span class="va">w</span><span class="op">)</span>  <span class="co"># also not the same!</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            t          x          y          z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t  2.4393350  1.3433462  0.4655575 -1.7114416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  1.3433462  1.5246884  0.1818389 -0.6684602</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  0.4655575  0.1818389  1.0630191 -0.2316653</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z -1.7114416 -0.6684602 -0.2316653  1.8516275</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">rot</span><span class="op">(</span><span class="va">u</span>,<span class="va">v</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              x           y           z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  0.996270498 -0.08387262  0.02026027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  0.086184168  0.97863167 -0.18668783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z -0.004169345  0.18773769  0.98221035</span>
<span class="r-in"><span><span class="fu">rot</span><span class="op">(</span><span class="va">v</span>,<span class="va">u</span><span class="op">)</span>    <span class="co"># transpose (=inverse) of rot(u,v)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             x           y            z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  0.99627050  0.08618417 -0.004169345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y -0.08387262  0.97863167  0.187737693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z  0.02026027 -0.18668783  0.982210352</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">rot</span><span class="op">(</span><span class="va">u</span>,<span class="va">v</span>,<span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu">boost</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu">boost</span><span class="op">(</span><span class="va">u</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            t           x           y          z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t  1.9785365  0.65773173  0.44312981 -1.5118305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  0.6577317  1.14524282  0.09785361 -0.3338482</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  0.4431298  0.09785361  1.06592635 -0.2249216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z -1.5118305 -0.33384815 -0.22492159  1.7673673</span>
<span class="r-in"><span><span class="fu">boost</span><span class="op">(</span><span class="va">u</span><span class="op">+</span><span class="va">v</span><span class="op">)</span>     <span class="co"># should be the same.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            t           x           y          z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t  1.9785365  0.65773173  0.44312981 -1.5118305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  0.6577317  1.14524282  0.09785361 -0.3338482</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  0.4431298  0.09785361  1.06592635 -0.2249216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z -1.5118305 -0.33384815 -0.22492159  1.7673673</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">orthog</span><span class="op">(</span><span class="fu">boost</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu">boost</span><span class="op">(</span><span class="va">v</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu">rot</span><span class="op">(</span><span class="va">u</span>,<span class="va">v</span>,<span class="cn">FALSE</span><span class="op">)</span>  <span class="co"># zero to numerical precision</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               t             x             y             z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t -5.995204e-15  2.929188e-15  5.215342e-16 -4.625683e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  6.930334e-15 -3.108624e-15 -4.024558e-16  6.009082e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  2.203957e-15 -1.332268e-15 -6.661338e-16  1.582068e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z -4.911564e-15  3.348884e-15  1.665335e-16 -4.440892e-15</span>
<span class="r-in"><span><span class="fu">pureboost</span><span class="op">(</span><span class="fu">boost</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu">boost</span><span class="op">(</span><span class="va">u</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu">boost</span><span class="op">(</span><span class="va">u</span><span class="op">+</span><span class="va">v</span><span class="op">)</span>   <span class="co"># ditto</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               t             x             y             z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t -4.440892e-16  1.110223e-16 -1.110223e-16  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  1.110223e-16  0.000000e+00  1.249001e-16 -1.054712e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y -1.110223e-16  1.249001e-16  2.220446e-16 -4.440892e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z  0.000000e+00 -1.054712e-15 -4.440892e-16  1.998401e-15</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Define a random-ish Lorentz transform</span></span></span>
<span class="r-in"><span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fu">boost</span><span class="op">(</span><span class="fu"><a href="r3vel.html">r3vel</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu">boost</span><span class="op">(</span><span class="fu"><a href="r3vel.html">r3vel</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu">boost</span><span class="op">(</span><span class="fu"><a href="r3vel.html">r3vel</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## check it:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span>    <span class="co"># needs emulator package</span></span></span>
<span class="r-in"><span><span class="fu">quad.form</span><span class="op">(</span><span class="fu"><a href="sol.html">eta</a></span><span class="op">(</span><span class="op">)</span>,<span class="va">L</span><span class="op">)</span>  <span class="co"># should be eta()</span></span></span>
<span class="r-in"><span> <span class="co"># \dontrun{}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## More concisely:</span></span></span>
<span class="r-in"><span><span class="fu">is.consistent.boost</span><span class="op">(</span><span class="va">L</span><span class="op">)</span>     <span class="co"># should be TRUE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Decompose L into a rotation and a pure boost:</span></span></span>
<span class="r-in"><span><span class="va">U</span> <span class="op">&lt;-</span> <span class="fu">orthog</span><span class="op">(</span><span class="va">L</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu">pureboost</span><span class="op">(</span><span class="va">L</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">L</span> <span class="op">-</span> <span class="va">U</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">P</span>              <span class="co"># should be zero (L = UP)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               t             x             y             z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t -4.440892e-16 -2.220446e-16  2.220446e-16  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x -1.110223e-16  1.665335e-16  1.110223e-16 -1.110223e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  4.440892e-16  2.220446e-16  2.220446e-16  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z  6.383782e-16  1.110223e-16 -4.440892e-16 -2.220446e-16</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">U</span><span class="op">)</span>               <span class="co"># should be identity (U is orthogonal)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               t            x             y             z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t  1.000000e+00 8.112473e-15 -3.945492e-15 -2.012791e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  8.112473e-15 1.000000e+00  3.272389e-15  1.515740e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y -3.945492e-15 3.272389e-15  1.000000e+00 -3.975003e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z -2.012791e-15 1.515740e-15 -3.975003e-16  1.000000e+00</span>
<span class="r-in"><span><span class="va">P</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span>                   <span class="co"># should be zero (P is symmetric)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               t             x             y             z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t  0.000000e+00 -2.220446e-16 -2.220446e-16  1.110223e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  2.220446e-16  0.000000e+00 -1.110223e-16  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  2.220446e-16  1.110223e-16  0.000000e+00 -1.110223e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z -1.110223e-16  0.000000e+00  1.110223e-16  0.000000e+00</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## First row of P should be a consistent 4-velocity:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fourvel.html">is.consistent.4vel</a></span><span class="op">(</span><span class="va">P</span><span class="op">[</span><span class="fl">1</span>,,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>,give<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             t </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -8.881784e-15 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robin K. S. Hankin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

