<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="The Lorentz transform in special relativity; also the
    gyrogroup structure of three-velocities.  Performs active and
    passive transforms and has the ability to use units in which the
    speed of light is not unity.  Includes some experimental
    functionality for celerity and rapidity.  For general relativity,
    see the schwarzschild package.  To cite the lorentz package in
    publications please use Hankin (2022)
    &lt;doi:10.48550/ARXIV.2212.07005&gt;.">
<title>The Lorentz Transform in Relativistic Physics • lorentz</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="The Lorentz Transform in Relativistic Physics">
<meta property="og:description" content="The Lorentz transform in special relativity; also the
    gyrogroup structure of three-velocities.  Performs active and
    passive transforms and has the ability to use units in which the
    speed of light is not unity.  Includes some experimental
    functionality for celerity and rapidity.  For general relativity,
    see the schwarzschild package.  To cite the lorentz package in
    publications please use Hankin (2022)
    &lt;doi:10.48550/ARXIV.2212.07005&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">lorentz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1-1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/RobinHankin/lorentz/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="the-lorentz-package-special-relativity-in-r">The lorentz package: special relativity in R<a class="anchor" aria-label="anchor" href="#the-lorentz-package-special-relativity-in-r"></a>
</h1></div>
<!-- README.md is generated from README.Rmd. Please edit that file -->
<!-- badges: start -->

</div>
<div class="section level1">
<h1 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h1>
<p><img src="../../../../Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/library/lorentz/help/figures/lorentz.png" width="20%" style="float:right; padding:10px"></p>
<p>The <code>lorentz</code> package furnishes some R-centric functionality for special relativity. Lorentz transformations of four-vectors are handled and some functionality for the stress energy tensor is given. The package deals with four-momentum and has facilities for dealing with photons and mirrors in relativistic situations. A detailed vignette is provided in the package.</p>
<p>The original motivation for the package was the investigation of the (nonassociative) gyrogroup structure of relativistic three-velocities under Einsteinian velocity composition. Natural R idiom may be used to manipulate vectors of three-velocities, although one must be careful with brackets.</p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>To install the most recent stable version on CRAN, use <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code> at the R prompt:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>R<span class="sc">&gt;</span> <span class="fu">install.packages</span>(<span class="st">"lorentz"</span>)</span></code></pre></div>
<p>To install the current development version use <code>devtools</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>R<span class="sc">&gt;</span> devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"RobinHankin/lorentz"</span>)</span></code></pre></div>
<p>And then to load the package use <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/RobinHankin/lorentz" class="external-link">"lorentz"</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="the-lorentz-package-in-use">The <code>lorentz</code> package in use<a class="anchor" aria-label="anchor" href="#the-lorentz-package-in-use"></a>
</h1>
<p>The package furnishes natural R idiom for working with three-velocities, four-velocities, and Lorentz transformations as four-by-four matrices. Although natural units in which <embed src="https://latex.codecogs.com/png.latex?c%3D1" title="c=1"></embed> are used by default, this can be changed.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/threevel.html">as.3vel</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>  <span class="co"># define a three-velocity, 0.6c to the right</span></span>
<span> <span class="va">u</span></span>
<span><span class="co">#&gt; A vector of three-velocities (speed of light = 1)</span></span>
<span><span class="co">#&gt;        x y z</span></span>
<span><span class="co">#&gt; [1,] 0.6 0 0</span></span>
<span></span>
<span><span class="fu"><a href="https://robinhankin.github.io/lorentz/reference/fourvel.html">as.4vel</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span>    <span class="co"># convert to a four-velocity:</span></span>
<span><span class="co">#&gt; A vector of four-velocities (speed of light = 1)</span></span>
<span><span class="co">#&gt;         t    x y z</span></span>
<span><span class="co">#&gt; [1,] 1.25 0.75 0 0</span></span>
<span><span class="fu"><a href="reference/gam.html">gam</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span>  <span class="co"># calculate the gamma term</span></span>
<span><span class="co">#&gt; [1] 1.25</span></span>
<span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/boost.html">boost</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="co"># give the Lorentz transformation</span></span>
<span><span class="va">B</span></span>
<span><span class="co">#&gt;       t     x y z</span></span>
<span><span class="co">#&gt; t  1.25 -0.75 0 0</span></span>
<span><span class="co">#&gt; x -0.75  1.25 0 0</span></span>
<span><span class="co">#&gt; y  0.00  0.00 1 0</span></span>
<span><span class="co">#&gt; z  0.00  0.00 0 1</span></span></code></pre></div>
<p>The boost matrix can be used to transform arbitrary four-vectors:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">B</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>  <span class="co"># Lorentz transform of an arbitrary four-vector</span></span>
<span><span class="co">#&gt;    [,1]</span></span>
<span><span class="co">#&gt; t -0.25</span></span>
<span><span class="co">#&gt; x  1.75</span></span>
<span><span class="co">#&gt; y  3.00</span></span>
<span><span class="co">#&gt; z  4.00</span></span></code></pre></div>
<p>But it can also be used to transform four-velocities:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://robinhankin.github.io/lorentz/reference/fourvel.html">as.4vel</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.7</span>,<span class="op">-</span><span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span>
<span><span class="co">#&gt;        [,1]</span></span>
<span><span class="co">#&gt; t  1.823312</span></span>
<span><span class="co">#&gt; x -1.093987</span></span>
<span><span class="co">#&gt; y  1.021055</span></span>
<span><span class="co">#&gt; z -0.291730</span></span></code></pre></div>
<p>The classical parallelogram law for addition of velocities is incorrect when relativistic effects are included. To combine <embed src="https://latex.codecogs.com/png.latex?u" title="u"></embed> and <embed src="https://latex.codecogs.com/png.latex?v" title="v"></embed> in terms of successive boosts we would simply multiply the boost matrices:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/boost.html">boost</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="reference/boost.html">boost</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span>
<span><span class="co">#&gt;           t     x          y          z</span></span>
<span><span class="co">#&gt; t  1.823312 -0.75 -1.2763187  0.3646625</span></span>
<span><span class="co">#&gt; x -1.093987  1.25  0.7657912 -0.2187975</span></span>
<span><span class="co">#&gt; y -1.021055  0.00  1.4240348 -0.1211528</span></span>
<span><span class="co">#&gt; z  0.291730  0.00 -0.1211528  1.0346151</span></span></code></pre></div>
<p>and note that the result depends on the order:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/boost.html">boost</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="reference/boost.html">boost</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span></span>
<span><span class="co">#&gt;            t          x          y          z</span></span>
<span><span class="co">#&gt; t  1.8233124 -1.0939874 -1.0210549  0.2917300</span></span>
<span><span class="co">#&gt; x -0.7500000  1.2500000  0.0000000  0.0000000</span></span>
<span><span class="co">#&gt; y -1.2763187  0.7657912  1.4240348 -0.1211528</span></span>
<span><span class="co">#&gt; z  0.3646625 -0.2187975 -0.1211528  1.0346151</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="vectorization">Vectorization<a class="anchor" aria-label="anchor" href="#vectorization"></a>
</h1>
<p>The package is fully vectorized and can deal with vectors whose entries are three-velocities or four-velocities:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span> <span class="co"># generate 5 random three-velocities:</span></span>
<span> <span class="op">(</span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/r3vel.html">r3vel</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; A vector of three-velocities (speed of light = 1)</span></span>
<span><span class="co">#&gt;           x       y      z</span></span>
<span><span class="co">#&gt; [1,]  0.230  0.0719  0.314</span></span>
<span><span class="co">#&gt; [2,] -0.311  0.4189 -0.277</span></span>
<span><span class="co">#&gt; [3,] -0.185  0.5099 -0.143</span></span>
<span><span class="co">#&gt; [4,] -0.739 -0.4641  0.129</span></span>
<span><span class="co">#&gt; [5,] -0.304 -0.2890  0.593</span></span>
<span> <span class="co"># calculate the gamma correction term:</span></span>
<span> <span class="fu"><a href="reference/gam.html">gam</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.09 1.24 1.21 2.13 1.46</span></span>
<span></span>
<span> <span class="co"># add a velocity of 0.9c in the x-direction:</span></span>
<span> <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/threevel.html">as.3vel</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="va">v</span><span class="op">+</span><span class="va">u</span></span>
<span><span class="co">#&gt; A vector of three-velocities (speed of light = 1)</span></span>
<span><span class="co">#&gt;          x      y      z</span></span>
<span><span class="co">#&gt; [1,] 0.936  0.026  0.113</span></span>
<span><span class="co">#&gt; [2,] 0.818  0.253 -0.168</span></span>
<span><span class="co">#&gt; [3,] 0.858  0.267 -0.075</span></span>
<span><span class="co">#&gt; [4,] 0.480 -0.605  0.168</span></span>
<span><span class="co">#&gt; [5,] 0.820 -0.174  0.356</span></span>
<span></span>
<span></span>
<span> <span class="co"># convert u to a four-velocity:</span></span>
<span> <span class="fu"><a href="https://robinhankin.github.io/lorentz/reference/fourvel.html">as.4vel</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span></span>
<span><span class="co">#&gt; A vector of four-velocities (speed of light = 1)</span></span>
<span><span class="co">#&gt;         t      x       y      z</span></span>
<span><span class="co">#&gt; [1,] 1.09  0.250  0.0783  0.341</span></span>
<span><span class="co">#&gt; [2,] 1.24 -0.385  0.5190 -0.343</span></span>
<span><span class="co">#&gt; [3,] 1.21 -0.223  0.6160 -0.173</span></span>
<span><span class="co">#&gt; [4,] 2.13 -1.571 -0.9862  0.273</span></span>
<span><span class="co">#&gt; [5,] 1.46 -0.443 -0.4209  0.864</span></span>
<span></span>
<span> <span class="co"># use four-velocities to effect the same transformation:</span></span>
<span> <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://robinhankin.github.io/lorentz/reference/fourvel.html">as.4vel</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="reference/boost.html">boost</a></span><span class="op">(</span><span class="op">-</span><span class="va">v</span><span class="op">)</span></span>
<span> <span class="fu"><a href="reference/threevel.html">as.3vel</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span>
<span><span class="co">#&gt; A vector of three-velocities (speed of light = 1)</span></span>
<span><span class="co">#&gt;          x      y      z</span></span>
<span><span class="co">#&gt; [1,] 0.936  0.026  0.113</span></span>
<span><span class="co">#&gt; [2,] 0.818  0.253 -0.168</span></span>
<span><span class="co">#&gt; [3,] 0.858  0.267 -0.075</span></span>
<span><span class="co">#&gt; [4,] 0.480 -0.605  0.168</span></span>
<span><span class="co">#&gt; [5,] 0.820 -0.174  0.356</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="three-velocities">Three-velocities<a class="anchor" aria-label="anchor" href="#three-velocities"></a>
</h1>
<p>Three-velocities behave in interesting and counter-intuitive ways.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/threevel.html">as.3vel</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>   <span class="co"># single three-velocity</span></span>
<span> <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/r3vel.html">r3vel</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">0.9</span><span class="op">)</span>              <span class="co"># 4 random three-velocities with speed 0.9</span></span>
<span> <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/threevel.html">as.3vel</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.1</span>,<span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>  <span class="co"># single three-velocity</span></span></code></pre></div>
<p>The three-velocity addition law is given by Ungar.</p>
<p>Then we can see that velocity addition is not commutative:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">u</span><span class="op">+</span><span class="va">v</span></span>
<span><span class="co">#&gt; A vector of three-velocities (speed of light = 1)</span></span>
<span><span class="co">#&gt;           x      y     z</span></span>
<span><span class="co">#&gt; [1,]  0.702 -0.113 0.567</span></span>
<span><span class="co">#&gt; [2,] -0.679  0.580 0.102</span></span>
<span><span class="co">#&gt; [3,] -0.046  0.879 0.364</span></span>
<span><span class="co">#&gt; [4,]  0.312  0.407 0.788</span></span>
<span> <span class="va">v</span><span class="op">+</span><span class="va">u</span></span>
<span><span class="co">#&gt; A vector of three-velocities (speed of light = 1)</span></span>
<span><span class="co">#&gt;           x      y     z</span></span>
<span><span class="co">#&gt; [1,]  0.624 -0.378 0.543</span></span>
<span><span class="co">#&gt; [2,] -0.823  0.358 0.045</span></span>
<span><span class="co">#&gt; [3,] -0.234  0.832 0.401</span></span>
<span><span class="co">#&gt; [4,]  0.228  0.190 0.892</span></span>
<span> <span class="op">(</span><span class="va">u</span><span class="op">+</span><span class="va">v</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="va">v</span><span class="op">+</span><span class="va">u</span><span class="op">)</span></span>
<span><span class="co">#&gt; A vector of three-velocities (speed of light = 1)</span></span>
<span><span class="co">#&gt;          x     y       z</span></span>
<span><span class="co">#&gt; [1,] 0.243 0.506  0.1190</span></span>
<span><span class="co">#&gt; [2,] 0.201 0.490  0.1206</span></span>
<span><span class="co">#&gt; [3,] 0.503 0.245 -0.0519</span></span>
<span><span class="co">#&gt; [4,] 0.242 0.564 -0.1105</span></span></code></pre></div>
<p>Observe that the difference between <code>u+v</code> and <code>v+u</code> is not “small” in any sense. Commutativity is replaced with gyrocommutatitivity:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare two different ways of calculating the same thing:</span></span>
<span> <span class="op">(</span><span class="va">u</span><span class="op">+</span><span class="va">v</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="reference/gyr.html">gyr</a></span><span class="op">(</span><span class="va">u</span>,<span class="va">v</span>,<span class="va">v</span><span class="op">+</span><span class="va">u</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; A vector of three-velocities (speed of light = 1)</span></span>
<span><span class="co">#&gt;              x         y         z</span></span>
<span><span class="co">#&gt; [1,]  3.53e-15 -1.20e-15  2.89e-15</span></span>
<span><span class="co">#&gt; [2,]  2.89e-16 -3.18e-15 -1.08e-16</span></span>
<span><span class="co">#&gt; [3,] -4.26e-15  1.09e-13  4.67e-14</span></span>
<span><span class="co">#&gt; [4,]  1.67e-15  4.76e-16  1.91e-15</span></span>
<span></span>
<span><span class="co"># The other way round:</span></span>
<span> <span class="op">(</span><span class="va">v</span><span class="op">+</span><span class="va">u</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="reference/gyr.html">gyr</a></span><span class="op">(</span><span class="va">v</span>,<span class="va">u</span>,<span class="va">u</span><span class="op">+</span><span class="va">v</span><span class="op">)</span></span>
<span><span class="co">#&gt; A vector of three-velocities (speed of light = 1)</span></span>
<span><span class="co">#&gt;              x         y         z</span></span>
<span><span class="co">#&gt; [1,]  3.21e-15 -6.42e-16  2.89e-15</span></span>
<span><span class="co">#&gt; [2,] -1.45e-15  1.73e-15  1.08e-16</span></span>
<span><span class="co">#&gt; [3,]  1.47e-14 -4.07e-14 -2.03e-14</span></span>
<span><span class="co">#&gt; [4,]  9.05e-15  6.43e-15  3.24e-14</span></span></code></pre></div>
<p>(that is, zero to numerical accuracy)</p>
<div class="section level2">
<h2 id="nonassociativity-of-three-velocities">Nonassociativity of three-velocities<a class="anchor" aria-label="anchor" href="#nonassociativity-of-three-velocities"></a>
</h2>
<p>It would be reasonable to expect that <code>u+(v+w)==(u+v)+w</code>. However, this is not the case:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="op">(</span><span class="op">(</span><span class="va">u</span><span class="op">+</span><span class="va">v</span><span class="op">)</span><span class="op">+</span><span class="va">w</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">u</span><span class="op">+</span><span class="op">(</span><span class="va">v</span><span class="op">+</span><span class="va">w</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; A vector of three-velocities (speed of light = 1)</span></span>
<span><span class="co">#&gt;             x       y         z</span></span>
<span><span class="co">#&gt; [1,]  0.00613  0.0794 -0.001467</span></span>
<span><span class="co">#&gt; [2,] -0.11096 -0.1508 -0.031226</span></span>
<span><span class="co">#&gt; [3,] -0.10748 -0.1022  0.000795</span></span>
<span><span class="co">#&gt; [4,] -0.05772 -0.0631 -0.007364</span></span></code></pre></div>
<p>(that is, significant departure from associativity). Associativity is replaced with gyroassociativity:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="op">(</span><span class="va">u</span><span class="op">+</span><span class="op">(</span><span class="va">v</span><span class="op">+</span><span class="va">w</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="op">(</span><span class="va">u</span><span class="op">+</span><span class="va">v</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="reference/gyr.html">gyr</a></span><span class="op">(</span><span class="va">u</span>,<span class="va">v</span>,<span class="va">w</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; A vector of three-velocities (speed of light = 1)</span></span>
<span><span class="co">#&gt;             x        y         z</span></span>
<span><span class="co">#&gt; [1,]  0.0e+00 8.16e-17 -6.53e-16</span></span>
<span><span class="co">#&gt; [2,] -3.8e-15 2.85e-15  9.49e-16</span></span>
<span><span class="co">#&gt; [3,]  0.0e+00 3.21e-15  1.60e-15</span></span>
<span><span class="co">#&gt; [4,]  0.0e+00 0.00e+00  0.00e+00</span></span>
<span> <span class="op">(</span><span class="op">(</span><span class="va">u</span><span class="op">+</span><span class="va">v</span><span class="op">)</span><span class="op">+</span><span class="va">w</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">u</span><span class="op">+</span><span class="op">(</span><span class="va">v</span><span class="op">+</span><span class="fu"><a href="reference/gyr.html">gyr</a></span><span class="op">(</span><span class="va">v</span>,<span class="va">u</span>,<span class="va">w</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; A vector of three-velocities (speed of light = 1)</span></span>
<span><span class="co">#&gt;              x         y         z</span></span>
<span><span class="co">#&gt; [1,]  0.00e+00  4.03e-17 -1.29e-15</span></span>
<span><span class="co">#&gt; [2,] -1.81e-15  9.07e-16  0.00e+00</span></span>
<span><span class="co">#&gt; [3,]  0.00e+00  1.37e-14  5.48e-15</span></span>
<span><span class="co">#&gt; [4,]  0.00e+00 -1.84e-15 -1.84e-15</span></span></code></pre></div>
<p>(zero to numerical accuracy).</p>
</div>
</div>
<div class="section level1">
<h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<p>The most concise reference is</p>
<ul>
<li>A. A. Ungar 2006. <em>Thomas precession: a kinematic effect of the algebra of Einstein’s velocity addition law. Comments on “Deriving relativistic momentum and energy: II, Three-dimensional case</em>. European Journal of Physics, 27:L17-L20</li>
</ul>
</div>
<div class="section level1">
<h1 id="further-information">Further information<a class="anchor" aria-label="anchor" href="#further-information"></a>
</h1>
<p>For more detail, see the package vignette</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">"lorentz"</span>)</span></code></pre></div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=lorentz" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/RobinHankin/lorentz/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/RobinHankin/lorentz/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing lorentz</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Robin K. S. Hankin <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-5982-0415" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/RobinHankin/lorentz/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/RobinHankin/lorentz/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://www.rdocumentation.org/packages/lorentz" class="external-link"><img src="https://www.rdocumentation.org/badges/version/lorentz" alt="Rdoc"></a></li>
<li><a href="https://app.codecov.io/gh/RobinHankin/lorentz/branch/master" class="external-link"><img src="https://app.codecov.io/gh/RobinHankin/lorentz/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Robin K. S. Hankin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
